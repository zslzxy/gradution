<!DOCTYPE html>
<!--商品的购买的选择、填写地址的页面-->
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:shiro="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <title>易恩商城管理员界面</title>
    <script th:src="@{/webjars/jquery/1.12.3/jquery.js}"></script>
    <script th:src="@{/webjars/bootstrap/3.3.7/js/bootstrap.js}"></script>
    <script th:src="@{/static/laydate/laydate.js}"></script>
    <script th:src="@{/static/js/html5shiv.min.js}"></script>
    <script th:src="@{/static/js/respond.min.js}"></script>
    <link th:href="@{/webjars/bootstrap/3.3.7/css/bootstrap.css}" rel="stylesheet">
    <link type="text/css" rel="stylesheet" th:href="@{/static/css/slick.css}"/>
    <link type="text/css" rel="stylesheet" th:href="@{/static/css/slick-theme.css}"/>
    <link type="text/css" rel="stylesheet" th:href="@{/static/css/nouislider.min.css}"/>
    <link rel="stylesheet" th:href="@{/static/css/font-awesome.min.css}">
    <link type="text/css" rel="stylesheet" th:href="@{/static/css/style.css}"/>
    <!--添加zTree-->
    <link rel="stylesheet" th:href="@{/static/css/zTree/zTreeStyle.css}" type="text/css">
    <script th:src="@{/static/js/zTree/jquery.ztree.core.min.js}"></script>
    <script th:src="@{/static/js/zTree/jquery.ztree.excheck.min.js}"></script>
    <script th:src="@{/static/js/zTree/jquery.ztree.exedit.min.js}"></script>
    <script th:src="@{/static/js/zTree/jquery.ztree.exhide.min.js}"></script>

    <style>
        .ztree-wrap {
            overflow: auto;
        }

        .pre-scrollable {
            max-height: 500px;
            overflow-y: scroll;
        }
    </style>

    <script>
        /**
         * 顶层四个button按钮，对应的模块切换
         */
        $(document).on("click", ".btn-top", function () {
            var id = $(this).attr("id")
            var cla = "." + id
            $(".detail-top").hide()
            $(cla).show()

        })


    </script>
</head>
<!-- HEADER -->
<header>
    <!-- 最上面的一排 -->
    <div id="top-header">
        <div class="container">
            <ul class="header-links pull-right" shiro:hasAnyRoles="admin">
                <li><a href="#"><i class="fa fa-dollar"></i>
                    <shiro:principal property="userName"/>
                    <a th:href="@{/login/logout}">，注销 </a></a></li>
                <li><a th:href="@{/user/myIndex}"><i class="glyphicon glyphicon-user"></i> 我的账户</a></li>
                <li><a th:href="@{/admin/toAdmin}"> <i class="fa fa-user-o"></i>管理员界面 </a></li>
            </ul>

            <ul class="header-links pull-right" shiro:notAuthenticated="">
                <li><a th:href="@{/login/toLogin}"><i class="fa fa-user-o"></i>登录 </a></li>
                <li><a th:href="@{/regist/toRegist}"><i class="fa fa-user-o"></i>注册 </a></li>
            </ul>

        </div>
    </div>

    <!-- 第二横排 -->
    <div id="header">
        <!-- container -->
        <div class="container">
            <!-- row -->
            <div class="row">
                <!-- LOGO -->
                <div class="col-md-3">
                    <div class="header-logo">
                        <a th:href="@{/index}" class="logo">
                            <img th:src="@{/static/img/logo2.jpg}" alt="" height="70" width="150">
                        </a>
                    </div>
                </div>
                <!-- /LOGO -->
                <div class="col-md-6">
                    <h1 style="color: #ffffff;margin: auto">易恩商城管理界面</h1>
                </div>

                <ul class="header-links pull-right" style="margin: auto;">
                    <li><a href="javascript:void(0)" onclick="alertAddMerchant()" style="color: #ffffff">新增商家</a></li>
                    <li><a href="javascript:void(0)" onclick="alertAddAdmin()" style="color: #ffffff">添加管理员账号</a></li>
                </ul>
            </div>
        </div>
    </div>
</header>

<div class="row">
    <div class="col-md-3">
        <button style="margin-left: 50px" id="goods_management_btn_top" class="btn btn-lg btn-default btn-top">正常商品管理
        </button>
    </div>
    <div class="col-md-3">
        <button style="margin-left: 50px" id="kill_goods_btn_top" class="btn btn-lg btn-default btn-top">秒杀商品管理</button>
    </div>
    <div class="col-md-3">
        <button style="margin-left: 50px" id="search_goods_btn_top" class="btn btn-lg btn-default btn-top">搜索商品管理
        </button>
    </div>
    <div class="col-md-3">
        <button style="margin-left: 50px" id="user_management_btn_top" class="btn btn-lg btn-default btn-top">用户信息管理
        </button>
    </div>
</div>

<div class="row">
    <!--查看商品的列表-->
    <div class="col-md-12 goods_management_btn_top detail-top" id="goods_management_detail_top">
        <h2 style="margin: auto;">商品管理</h2>
        <div class="col-md-12">
        </div>
        <div class="col-md-12 pre-scrollable" style="overflow:scroll">
            <div class="row" id="div_goods_tree">
                <ul id="goodsTree" class="ztree "></ul>
            </div>
        </div>
    </div>


    <!--查看需要加入秒杀队列的商品的请求-->
    <div class="col-md-12 kill_goods_btn_top detail-top" id="kill_goods_detail_top" hidden="hidden">
        <h2 style="margin: auto">秒杀商品管理</h2>
        <button id="WK" class="btn btn-default kill_state">待审核</button>
        <button id="NK" class="btn btn-success kill_state">待秒杀</button>
        <button id="UK" class="btn btn-success kill_state">正秒杀</button>
        <button id="HK" class="btn btn-warning kill_state">已秒杀</button>
        <button id="KK" class="btn btn-danger kill_state">已取消</button>
        <button id="show_kill_time" class="btn btn-default show_kill_time">查看秒杀时间</button>
        <button id="add_kill_time" class="btn btn-default add_kill_time">新增秒杀时间</button>
        <button id="restart_kill_model" class="btn btn-default restart_kill_model">重启秒杀模块</button>
        <div style="overflow:scroll" CLASS="pre-scrollable">
            <table id="kill_goods_table" class="table table-hover">
                <thead>
                <th>复选框</th>
                <th hidden="hidden">秒杀表唯一索引</th>
                <th hidden="hidden">商品表唯一索引</th>
                <th>商品名称</th>
                <th>商品秒杀价</th>
                <th>商品原价</th>
                <th>秒杀状态</th>
                <th>秒杀时间</th>
                </thead>
                <tbody>

                </tbody>
            </table>
        </div>
    </div>

    <!--查询商品管理界面-->
    <div class="col-md-12 search_goods_btn_top detail-top" id="search_goods_detail_top" hidden="hidden">
        <h2 style="margin: auto">搜索商品管理</h2>
        <button class="btn btn-success">新增商品到ES</button>
        <button class="btn btn-success">删除ES商品索引</button>
        <button class="btn btn-success">重新导入所有商品到ES</button>
        <div class="container-fluid">
            <table class="table table-hover">
                <thead>
                <th>商品名称</th>
                <th>商品原价</th>
                <th>商品现价</th>
                <th>商品库存</th>
                <th>商品状态</th>
                <th>商品商家</th>
                <th>商品售时</th>
                <th>商品停时</th>
                <th>其他操作</th>
                </thead>
                <tbody id="goods_list">

                </tbody>
            </table>
        </div>
        <div class="row" style="margin-top: 100px">
            <!--分页文字信息  -->
            <div class="col-md-4" id="page_info_area_goods" style="margin: auto"></div>
            <!-- 分页条信息 -->
            <div class="col-md-6" id="page_nav_area_goods">

            </div>
        </div>
    </div>

    <!--用户管理的模块-->
    <div class="col-md-12 user_management_btn_top detail-top" id="user_management_detail_top" hidden="hidden">
        <table class="table table-hover">
            <thead>
            <th>多选</th>
            <th>用户账号</th>
            <th>用户姓名</th>
            <th>用户性别</th>
            <th>用户证件</th>
            <th>用户邮箱</th>
            <th>用户电话</th>
            <th>用户积分</th>
            <th>用户金额</th>
            <th>用户生日</th>
            <th>用户状态</th>
            <th>用户地址</th>
            <th>用户等级</th>
            <th>发送邮件</th>
            <th>修改</th>
            <th>删除</th>
            </thead>
            <tbody id="user_management_tbody">

            </tbody>
        </table>
        <div class="row" style="margin-top: 100px">
            <!--分页文字信息  -->
            <div class="col-md-4" id="page_info_area_user" style="margin: auto"></div>
            <!-- 分页条信息 -->
            <div class="col-md-6" id="page_nav_area_user">

            </div>
        </div>
    </div>
</div>


<!-- 添加管理员 -->
<div class="modal fade" id="addAdmin" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title">新增管理员</h4>
            </div>
            <div class="modal-body">
                <form class="form-horizontal" id="addAdminForm">
                    <div class="form-group">
                        <label class="col-sm-3 control-label">管理员账号</label>
                        <div class="col-sm-9">
                            <input type="text" name="userId" class="form-control" id="adminId" placeholder="请输入账号">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">管理员姓名</label>
                        <div class="col-sm-9">
                            <input type="text" name="userName" class="form-control" id="adminName" placeholder="管理员姓名">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">管理员密码</label>
                        <div class="col-sm-9">
                            <input type="text" name="userPassword" class="form-control" id="adminPassword"
                                   placeholder="管理员密码">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">管理员身份证号</label>
                        <div class="col-sm-9">
                            <input type="text" name="userCardNo" class="form-control" id="adminCardNo"
                                   placeholder="管理员身份证号">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">管理员邮箱</label>
                        <div class="col-sm-9">
                            <input type="text" name="userEmail" class="form-control" id="adminEmail"
                                   placeholder="管理员身份证号">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">管理员电话号码</label>
                        <div class="col-sm-9">
                            <input type="text" name="userMobileNo" class="form-control" id="adminMobileNo"
                                   placeholder="管理员身份证号">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">管理员地址</label>
                        <div class="col-sm-9">
                            <input type="text" name="userAddress" class="form-control" id="adminAddress"
                                   placeholder="管理员身份证号">
                            <span class="help-block"></span>
                        </div>
                    </div>
                </form>
                <form class="form-horizontal" id="adminPassForm">
                    <div class="form-group">
                        <label class="col-sm-3 control-label">管理管理员密码</label>
                        <div class="col-sm-9">
                            <input type="password" name="managementPassword" class="form-control"
                                   id="managementAdminPassword" placeholder="请输入创建会员密码">
                            <span class="help-block"></span>
                        </div>
                    </div>
                </form>
            </div>

            <div class="modal-footer">
                <span id="addAdminResultSpan" style="color: red"></span>
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <a class="btn btn-primary" id="addAdminBtn" href="javascript:void(0)" onclick="addAdmin()">点击新增</a>
            </div>
        </div>
    </div>
</div>

<!-- 添加商家 -->
<div class="modal fade" id="addMerchant" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="merchants_id_text">新增商户</h4>
            </div>
            <div class="modal-body">
                <form class="form-horizontal" id="addMerchantForm">
                    <div class="form-group" hidden="hidden">
                        <label class="col-sm-3 control-label">id</label>
                        <div class="col-sm-9">
                            <input type="text" name="id" class="form-control" id="merchant_id"
                                   placeholder="商家易恩账号">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">商家易恩账号</label>
                        <div class="col-sm-9">
                            <input type="text" name="merchantsUserId" class="form-control" id="merchantsUserId"
                                   placeholder="商家易恩账号">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">商家姓名</label>
                        <div class="col-sm-9">
                            <input type="text" name="merchantsAuthorName" class="form-control" id="merchantsAuthorName"
                                   placeholder="商家姓名">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">店铺名称</label>
                        <div class="col-sm-9">
                            <input type="text" name="merchantsStoreName" class="form-control" id="merchantsStoreName"
                                   placeholder="店铺名称">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">店铺地址</label>
                        <div class="col-sm-9">
                            <input type="text" name="merchantsStorePlace" class="form-control" id="merchantsStorePlace"
                                   placeholder="店铺地址">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">商家邮箱</label>
                        <div class="col-sm-9">
                            <input type="text" name="merchantsAuthorEmail" class="form-control"
                                   id="merchantsAuthorEmail" placeholder="商家邮箱">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">商家电话号码</label>
                        <div class="col-sm-9">
                            <input type="text" name="merchantsAuthorMobile" class="form-control"
                                   id="merchantsAuthorMobile" placeholder="商家电话号码">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">店铺创建时间</label>
                        <div class="col-sm-9">
                            <input type="text" name="merchantsCreateTime" class="form-control" id="merchantsCreateTime"
                                   placeholder="店铺创建时间：yyyy-MM-dd">
                            <span class="help-block"></span>
                        </div>
                    </div>
                </form>
                <form class="form-horizontal" id="merchantPassForm">
                    <div class="form-group">
                        <label class="col-sm-3 control-label">管理商家密码</label>
                        <div class="col-sm-9">
                            <input type="password" name="managementPassword" class="form-control"
                                   id="managementMerchantPassword" placeholder="请输入创建会员密码">
                            <span class="help-block"></span>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <span id="add_merchant_span"></span>
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <a class="btn btn-primary" id="AddMerchantBtn" href="javascript:void(0)"
                   onclick="addMerchant()">点击新增</a>
                <a class="btn btn-primary" id="updateMerchantBtn" href="javascript:void(0)"
                   onclick="updateMerchant()">点击修改</a>

            </div>
        </div>
    </div>
</div>

<!-- 商品详情展示弹出框 -->
<div class="modal fade" id="showGoods" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title">商品详情展示</h4>
            </div>
            <div class="modal-body">
                <form class="form-horizontal" id="goodsShowForm">
                    <div class="form-group" hidden="hidden">
                        <label class="col-sm-3 control-label">商品id</label>
                        <div class="col-sm-9">
                            <input type="text" name="id" class="form-control" id="goods_Id" placeholder="商品的id">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group" hidden="hidden">
                        <label class="col-sm-3 control-label">商品唯一索引id</label>
                        <div class="col-sm-9">
                            <input type="text" name="goodsId" class="form-control" id="goodsId" placeholder="商品的唯一索引id">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">商品名称</label>
                        <div class="col-sm-9">
                            <input type="text" name="goodsName" class="form-control" id="goodsName" placeholder="商品的名称">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">商品原价</label>
                        <div class="col-sm-9">
                            <input type="text" name="goodsDefaultAmount" class="form-control" id="goodsDefaultAmount"
                                   placeholder="商品的原价">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">商品现价</label>
                        <div class="col-sm-9">
                            <input type="text" name="goodsNowAmount" class="form-control" id="goodsNowAmount"
                                   placeholder="商品的现价">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">商品商家id</label>
                        <div class="col-sm-9">
                            <input type="text" name="goodsMerchantsId" class="form-control" id="goodsMerchantsId"
                                   placeholder="商品的商家id">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">商品商家名称</label>
                        <div class="col-sm-9">
                            <input type="text" name="goodsMerchantsName" class="form-control" id="goodsMerchantsName"
                                   placeholder="商品的商家名称">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">商品销售状态</label>
                        <div class="col-sm-9">
                            <input type="text" name="goodsState" class="form-control" id="goodsState"
                                   placeholder="商品的销售状态">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">商品开售时间</label>
                        <div class="col-sm-9">
                            <input type="text" name="goodsSellTime" class="form-control" id="goodsSellTime"
                                   placeholder="商品的开售时间">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">商品停售时间</label>
                        <div class="col-sm-9">
                            <input type="text" name="goodsDiscontinuedTime" class="form-control"
                                   id="goodsDiscontinuedTime" placeholder="商品的停售时间">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">商品库存</label>
                        <div class="col-sm-9">
                            <input type="text" name="goodsInventory" class="form-control" id="goodsInventory"
                                   placeholder="商品库存">
                            <span class="help-block"></span>
                        </div>
                    </div>
                </form>
            </div>

            <div class="modal-footer">
                <span id="show_goods_span"></span>
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <a class="btn btn-primary" id="toGoodsDetails" href="javascript:void(0)" onclick="toGoodsDetails()">查看商品详情</a>
                <a class="btn btn-primary" id="updateGoods" href="javascript:void(0)" onclick="updateGoods()">确认修改</a>
            </div>
        </div>
    </div>
</div>

<!--秒杀商品展示-->
<div class="modal fade" id="showKillGoods" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="killGoodsManagement">审核秒杀商品</h4>
            </div>
            <div class="modal-body">
                <form class="form-horizontal" id="killGoodsForm">
                    <div class="form-group" hidden="hidden">
                        <label class="col-sm-3 control-label">id</label>
                        <div class="col-sm-9">
                            <input type="text" name="id" class="form-control" id="kill_goods_id" placeholder="秒杀商品id">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group" hidden="hidden">
                        <label class="col-sm-3 control-label">killid</label>
                        <div class="col-sm-9">
                            <input type="text" name="killId" class="form-control" id="killId">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group" hidden="hidden">
                        <label class="col-sm-3 control-label">killGoodsId</label>
                        <div class="col-sm-9">
                            <input type="text" name="killGoodsId" class="form-control" id="killGoodsId">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">商品名称</label>
                        <div class="col-sm-9">
                            <input type="text" name="killGoodsName" class="form-control" id="killGoodsName"
                                   placeholder="商品名称">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">商品秒杀价</label>
                        <div class="col-sm-9">
                            <input type="text" name="killGoodsAmount" class="form-control" id="killGoodsAmount"
                                   placeholder="商品秒杀价">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">商品秒杀数量</label>
                        <div class="col-sm-9">
                            <input type="text" name="killNum" class="form-control" id="killNum"
                                   placeholder="商品秒杀数量">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">商品原价</label>
                        <div class="col-sm-9">
                            <input type="text" name="killDefaultAmount" class="form-control"
                                   id="killDefaultAmount" placeholder="商品原价">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">商品状态</label>
                        <div class="col-sm-9">
                            <select name="killGoodsState" id="killGoodsState">
                                <option value="NK">等待秒杀</option>
                                <option value="WK">等待审核</option>
                                <option value="KK">拒绝参加秒杀</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">秒杀时间</label>
                        <div class="col-sm-9">
                            <!--<input type="text" name="killGoodsTime" class="form-control" id="killGoodsTime">-->
                            <!--<span class="help-block"></span>-->
                            <select name="killGoodsTime" class="form-control" id="killGoodsTime">
                                <option></option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <span id="show_kill_goods_span"></span>
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <a class="btn btn-primary" id="managementKillGoods" href="javascript:void(0)"
                   onclick="managementKillGoods()">确认审核</a>
            </div>
        </div>
    </div>
</div>

<!--新增秒杀时间-->
<div class="modal fade" id="addKillTime" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title">新增秒杀时间</h4>
            </div>
            <div class="modal-body">
                <form class="form-horizontal" id="addKillTimeForm">
                    <div class="form-group">
                        <label class="col-sm-3 control-label">秒杀预热时间:</label>
                        <div class="col-sm-9">
                            <input type="text" name="preTime" class="form-control" id="pre_time"
                                   placeholder="yyyy-MM-dd">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">秒杀开始时间:</label>
                        <div class="col-sm-9">
                            <input type="text" name="killTime" class="form-control" id="kill_time"
                                   placeholder="yyyy-MM-dd">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">秒杀结束时间:</label>
                        <div class="col-sm-9">
                            <input type="text" name="endTime" class="form-control" id="end_time"
                                   placeholder="yyyy-MM-dd">
                            <span class="help-block"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">秒杀描述:</label>
                        <div class="col-sm-9">
                            <input type="text" name="killDetail" class="form-control" id="kill_detail">
                            <span class="help-block"></span>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <span id="add_kill_time_span"></span>
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <a class="btn btn-primary" id="add_kil_time_btn" href="javascript:void(0)"
                   onclick="addKillTime()">点击新增</a>
            </div>
        </div>
    </div>
</div>

<!--查看秒杀时间-->
<div class="modal fade" id="showKillTime" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form class="form-horizontal" action="#">
                    <table class="table table-hover">
                        <thead>
                        <th hidden="hidden">id</th>
                        <th>预热时间</th>
                        <th>秒杀时间</th>
                        <th>结束时间</th>
                        <th>秒杀描述</th>
                        </thead>
                        <tbody id="show_kill_time_table">

                        </tbody>
                    </table>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            </div>
        </div>
    </div>
</div>


<script>

    var state = "WK";
    $(function () {
        findKillGoods(state)
    })

    $(".kill_state").click(function () {
        var id = $(this).attr("id")
        findKillGoods(id)
    })

    /**
     * 查询出秒杀商品进行分类
     */
    function findKillGoods(state) {
        $("#kill_goods_table tbody").html("");
        $.ajax({
            url: "/kill/findKillGoodsByState.html",
            type: "POST",
            data: {
                state: state
            },
            success: function (result) {
                console.log(result)
                eachKillGoods(result, state)
            }
        })
    }

    /**
     * 遍历秒杀商品
     */
    function eachKillGoods(list, state) {
        $.each(list, function (index, value) {
            var checkBoxTd = $("<td><input type='checkbox' class='check_item'/></td>");
            var id = $("<td hidden='hidden'></td>").append(value.id);
            var killId = $("<td hidden='hidden'></td>").append(value.killId);
            var killGoodsId = $("<td hidden='hidden'></td>").append(value.killGoodsId);
            var killGoodsName = $("<td></td>").append(value.killGoodsName);
            var killDefaultAmount = $("<td></td>").append(value.killDefaultAmount);
            var killGoodsAmount = $("<td></td>").append(value.killGoodsAmount);
            var killNum = $("<td></td>").append(value.killNum);
            var killGoodsState = $("<td></td>");
            if (state == "UK") {
                killGoodsState.append("正在秒杀")
            } else if (state == "KK") {
                killGoodsState.append("拒绝参加秒杀")
            } else if (state == "NK") {
                killGoodsState.append("等待秒杀")
            } else if (state == "WK") {
                killGoodsState.append("等待审核")
            } else if (state == "HK") {
                killGoodsState.append("已参与秒杀")
            }
            var killGoodsTime = $("<td></td>").append(value.killGoodsTime);
            var editBtn = $("<button></button>").addClass("btn btn-primary btn-sm edit_btn_kill_goods")
                .append($("<span></span>").addClass("glyphicon glyphicon-pencil")).append("点击审核");
            $("<tr></tr>").append(checkBoxTd)
                .append(id)
                .append(killId)
                .append(killGoodsId)
                .append(killGoodsName)
                .append(killGoodsAmount)
                .append(killDefaultAmount)
                .append(killGoodsState)
                .append(killGoodsTime)
                .append(killNum)
                .append(editBtn)
                .appendTo("#kill_goods_table tbody");
            if (state != "WK") {
                editBtn.hide()
            }
        })
    }

    $(document).on("click", ".edit_btn_kill_goods", function () {
        $("#kill_goods_id").val($(this).parent().find("td:eq(1)").text())
        $("#killId").val($(this).parent().find("td:eq(2)").text())
        $("#killGoodsId").val($(this).parent().find("td:eq(3)").text())
        $("#killGoodsName").val($(this).parent().find("td:eq(4)").text())
        $("#killGoodsAmount").val($(this).parent().find("td:eq(5)").text())
        $("#killDefaultAmount").val($(this).parent().find("td:eq(6)").text())
        $("#killNum").val($(this).parent().find("td:eq(9)").text())

        var value1 = $(this).parent().find("td:eq(8)").text().replace(/\ +/g, "")
        $("#killGoodsTime option[value='" + value1 + "']").attr("selected", "selected");

        if ($(this).parent().find("td:eq(7)").text() == "正在秒杀") {
            var tem = "UK"
            $("#killGoodsState option[value='" + tem + "']").attr("selected", "selected");
        } else if ($(this).parent().find("td:eq(7)").text() == "拒绝参加秒杀") {
            var tem = "KK"
            $("#killGoodsState option[value='" + tem + "']").attr("selected", "selected");
        } else if ($(this).parent().find("td:eq(7)").text() == "等待秒杀") {
            var tem = "NK"
            $("#killGoodsState option[value='" + tem + "']").attr("selected", "selected");
        } else if ($(this).parent().find("td:eq(7)").text() == "等待审核") {
            var tem = "WK"
            $("#killGoodsState option[value='" + tem + "']").attr("selected", "selected");
        } else if ($(this).parent().find("td:eq(7)").text() == "已参与秒杀") {
            var tem = "HK"
            $("#killGoodsState option[value='" + tem + "']").attr("selected", "selected");
        }
        //弹出模态框
        $("#showKillGoods").modal({
            backdrop: "static"
        })
    })

    /**
     * 点击审核
     */
    function managementKillGoods() {
        var id = $("#kill_goods_id").val()
        var killId = $("#killId").val()
        var killGoodsId = $("#killGoodsId").val()
        var killGoodsAmount = $("#killGoodsAmount").val()
        var killDefaultAmount = $("#killDefaultAmount").val()
        var killGoodsName = $("#killGoodsName").val()
        var killGoodsState = $("#killGoodsState").val()
        var killGoodsTime = $("#killGoodsTime").val()
        var killNum = $("#killNum").val()
        var be = killGoodsTime.substring(0, 10)
        var af = killGoodsTime.substring(10, 18)
        killGoodsTime = be + " " + af

        $.ajax({
            url: "/kill/updateKillGoods",
            type: "POST",
            data: {
                id: id,
                killId: killId,
                killGoodsId: killGoodsId,
                killGoodsAmount: killGoodsAmount,
                killDefaultAmount: killDefaultAmount,
                killGoodsName: killGoodsName,
                killGoodsState: killGoodsState,
                killGoodsTime: killGoodsTime,
                killNum: killNum
            },
            success: function (result) {
                alert(result.info)
                closeShowKillGoodsFun()
                // window.location.reload()
                //清空秒杀table
                findKillGoods("WK")

            }
        })
    }

    /**
     * 关闭秒杀弹出框
     */
    function closeShowKillGoodsFun() {
        $("#showKillGoods").modal('hide')
    }

    /**
     * 生成商品结构树
     */
    var zTreeObj;
    var zNodes;
    //zTree的设置
    var setting = {
        callback: {
            onClick: goodsZTreeOnClick,
        },
        view: {
            showIcon: true
        },
        check: {
            enable: true
        },
        data: {
            simpleData: {
                enable: true,
                idKey: "id",
                pIdKey: "pId"
            }
        },
        edit: {
            isSimpleData: true, //数据是否采用简单 Array 格式，默认false
            treeNodeKey: "id",  //在isSimpleData格式下，当前节点id属性
            treeNodeParentKey: "pId",//在isSimpleData格式下，当前节点的父节点id属性
            showLine: true //是否显示节点间的连线
        },
        async: {
            enable: true,
            url: "/admin/createzTree.html",
            type: "post",
        }
    }

    $(function () {
        $.ajax({
            url: "/admin/createzTree.html",
            type: "POST",
            success: function (result) {
                console.log(result)
                var eval1 = eval(result)
                zNodes = eval1
                zTreeObj = $.fn.zTree.init($("#goodsTree"), setting, zNodes);
                //默认设置为展开全部
                //zTreeObj.expandAll(true);
                var nodes = zTreeObj.getNodes();
                for (var i = 0; i < nodes.length; i++) { //设置节点展开第二级节点
                    zTreeObj.expandNode(nodes[i], true, false, true);
                    var nodespan = nodes[i].children;
                    for (var j = 0; j < nodespan.length; j++) { //设置节点展开第三级节点
                        zTreeObj.expandNode(nodespan[j], true, false, true);
                    }
                }
            }
        })
    })

    /**
     * 商品的树的点击事件
     */
    function goodsZTreeOnClick(event, treeId, treeNode) {
        $("#show_goods_span").empty()
        //得到对应的节点树
        var treeObj = $.fn.zTree.getZTreeObj("goodsTree");
        //得到当前点击的节点
        var node = treeObj.getNodeByTId(treeNode.tId);
        //得到当前节点的子节点
        var nodes = node.children;

        //如果该这个节点指的是小店，则对这个节点添加事件
        if (node.pId == -2) {
            $("#merchants_id_text").text("商家详细信息")
            //查询对应的商家的数据
            findByMerchantsId(node.id)

            $("#updateMerchantBtn").show()
            $("#AddMerchantBtn").hide()
            //弹出模态框
            $("#addMerchant").modal({
                backdrop: "static"
            })

            return false
        }
        if (nodes == null) {
            //弹出模态框
            $("#showGoods").modal({
                backdrop: "static"
            })
            //执行操作
            $.ajax({
                url: "/goods/goodsWindow",
                type: "POST",
                data: {
                    goodsId: node.id
                },
                success: function (result) {
                    appendToGoodsWindow(result)
                }
            })
        }
    }

    /**
     * 将商品添加到商品的弹出框中
     */
    function appendToGoodsWindow(result) {
        $("#goods_Id").val(result.id)
        $("#goodsId").val(result.goodsId)
        $("#goodsName").val(result.goodsName)
        $("#goodsNowAmount").val(result.goodsNowAmount)
        $("#goodsDefaultAmount").val(result.goodsDefaultAmount)
        $("#goodsMerchantsId").val(result.goodsMerchantsId)
        $("#goodsMerchantsName").val(result.goodsMerchantsName)
        $("#goodsState").val(result.goodsState)
        $("#goodsSellTime").val(result.goodsSellTime)
        $("#goodsDiscontinuedTime").val(result.goodsDiscontinuedTime)
        $("#goodsInventory").val(result.goodsInventory)
    }

    /**
     * 自动调用插件生成对应的日期
     */
    laydate.render({
        elem: '#merchantsCreateTime' //指定元素
        , type: 'datetime'
    });
    laydate.render({
        elem: '#goodsSellTime' //指定元素
        , type: 'datetime'
    });
    laydate.render({
        elem: '#goodsDiscontinuedTime' //指定元素
        , type: 'datetime'
    });

    laydate.render({
        elem: '#kill_time' //指定元素
        , type: 'datetime'
    });
    laydate.render({
        elem: '#pre_time' //指定元素
        , type: 'datetime'
    });
    laydate.render({
        elem: '#end_time' //指定元素
        , type: 'datetime'
    });

    function toGoodsDetails() {
        var goodsId = $("#goodsId").val()
        window.location.href = "/goods/goodDetail/" + goodsId
    }

    function updateGoods() {
        $.ajax({
            url: "/goods/updateGoods",
            type: "POST",
            data: $("#goodsShowForm").serialize(),
            success: function (result) {
                $("#show_goods_span").empty()
                $("#show_goods_span").append(result.info)
                if (result.code == 100) {
                    setTimeout("closeAdminWindow()", 3000)
                }
            }
        })
    }

    /**
     * 点击新增管理员  按钮弹出模态框。
     */
    function alertAddAdmin() {
        $("#addAdminResultSpan").empty()
        //弹出模态框
        $("#addAdmin").modal({
            backdrop: "static"
        })
    };

    /**
     * 点击新增管理员
     */
    function addAdmin() {
        var password = $("#managementAdminPassword").val()
        var adminId = $("#adminId").val();
        var adminName = $("#adminName").val()
        var adminPassword = $("#adminPassword").val()
        var adminAddress = $("#adminAddress").val()
        var adminCardNo = $("#adminCardNo").val()
        var adminEmail = $("#adminEmail").val()
        var adminMobile = $("#adminMobileNo").val()
        $.ajax({
            url: "/admin/addAdmin.html",
            type: "POST",
            data: {
                adminId: adminId,
                adminName: adminName,
                adminPassword: adminPassword,
                adminAddress: adminAddress,
                adminCardNo: adminCardNo,
                adminEmail: adminEmail,
                adminMobile: adminMobile,
                password: password
            },
            success: function (result) {
                console.log(result)
                $("#addAdminResultSpan").empty()
                $("#addAdminResultSpan").append(result.info)
                if (result.code == 100) {
                    setTimeout("closeAdminWindow()", 3000)
                }
            }
        })
    }

    /**
     * 关闭新增管理员的窗口
     */
    function closeAdminWindow() {
        $("#addAdminResultSpan").empty()
        $("#addAdmin").modal('hide');
    }

    /**
     * 关闭商品弹出框
     */
    function closeAdminWindow() {
        $("#show_goods_span").empty()
        $("#showGoods").modal('hide');
    }

    /**
     * 点击新增商家  按钮弹出模态框。
     */
    function alertAddMerchant() {
        $("#updateMerchantBtn").hide()
        $("#AddMerchantBtn").show()
        $("#addMerchantForm")[0].reset();
        $("#merchants_id_text").text("新增商家")
        //弹出模态框
        $("#addMerchant").modal({
            backdrop: "static"
        })
    };

    /**
     * 点击新增商家
     */
    function addMerchant() {
        var password = $("#managementMerchantPassword").val()
        $.ajax({
            url: "/merchants/addMerchant.html?password=" + password,
            type: "POST",
            data: $("#addMerchantForm").serialize(),
            success: function (result) {
                console.log(result)
                $("#add_merchant_span").empty()
                $("#add_merchant_span").append(result.info)
                if (result.code == 100) {
                    setTimeout("closeMerchantWindow()", 3000)
                }
            }
        })
    }

    /**
     * 点击修改商家
     */
    function updateMerchant() {
        var password = $("#managementMerchantPassword").val()
        $.ajax({
            url: "/merchants/updateMerchant.html?password=" + password,
            type: "POST",
            data: $("#addMerchantForm").serialize(),
            success: function (result) {
                console.log(result)
                $("#add_merchant_span").empty()
                $("#add_merchant_span").append(result.info)
                if (result.code == 100) {
                    setTimeout("closeMerchantWindow()", 3000)
                }
            }
        })
    }

    /**
     * 关闭新增商家的窗口
     */
    function closeMerchantWindow() {
        $("#add_merchant_span").empty()
        $("#addMerchant").modal('hide')
    }

    /**
     * 查询对应的商家id的对象的数据
     */
    function findByMerchantsId(merchantsId) {
        $.ajax({
            url: "/merchants/findByMerchantsId.html",
            type: "POST",
            data: {
                id: merchantsId
            },
            success: function (result) {
                console.log(result)
                appendMerchants(result)
            }
        })
    }

    /**
     * 将商家数据添加到商家弹出框中
     * @param item
     */
    function appendMerchants(item) {
        $("#add_merchant_span").empty()
        $("#merchant_id").val(item.extend.merchants.id)
        $("#merchantsUserId").val(item.extend.merchants.merchantsUserId)
        $("#merchantsAuthorName").val(item.extend.merchants.merchantsAuthorName)
        $("#merchantsStoreName").val(item.extend.merchants.merchantsStoreName)
        $("#merchantsStorePlace").val(item.extend.merchants.merchantsStorePlace)
        $("#merchantsAuthorEmail").val(item.extend.merchants.merchantsAuthorEmail)
        $("#merchantsAuthorMobile").val(item.extend.merchants.merchantsAuthorMobile)
        $("#merchantsCreateTime").val(item.extend.merchants.merchantsCreateTime)
    }

    $(function () {
        $.ajax({
            url: "/kill/killTimeOnlyString",
            type: "GET",
            success: function (result) {
                $.each(result, function (index, item) {
                    var value = item.replace(/\ +/g, "")
                    $("#killGoodsTime").append("<option value=" + value + ">" + item + "</option>");
                })
            }
        })
    })

    /**
     * 新增秒杀日期
     */
    function addKillTime() {
        $.ajax({
            url: "/kill/addKillTime",
            type: "POST",
            data: $("#addKillTimeForm").serialize(),
            success: function (result) {
                alert(result.info)
            }
        })
    }

    $("#add_kill_time").click(function () {
        //弹出模态框
        $("#addKillTime").modal({
            backdrop: "static"
        })
    })

    $(document).on("click", "#show_kill_time", function () {
        $("#show_kill_time_table").empty()
        addKillTimes()
        //弹出模态框
        //弹出模态框
        $("#showKillTime").modal({
            backdrop: "static"
        })
    })

    $(function () {
        addKillTimes()
    })

    /**
     * 当点击查看秒杀时间以后，刷新对应的表格数据，重新为表单数据赋值
     */
    function addKillTimes() {
        $.ajax({
            url: "/kill/killAllTime",
            type: "GET",
            success: function (result) {
                $.each(result, function (index, item) {
                    var id = $("<td hidden='hidden'></td>").append(item.id);
                    var killTime = $("<td></td>").append(item.killTime);
                    var preTime = $("<td></td>").append(item.preTime);
                    var endTime = $("<td></td>").append(item.endTime);
                    var killDetail = $("<td></td>").append(item.killDetail);
                    var deletetime = $("<button class='btn btn-danger btn-delete-kill-time'>删除</button>");
                    $("<tr></tr>").append(id)
                        .append(preTime)
                        .append(killTime)
                        .append(endTime)
                        .append(killDetail)
                        .append(deletetime)
                        .appendTo("#show_kill_time_table")
                })
            }
        })
    }

    $(document).on("click", ".btn-delete-kill-time", function () {
        var id = $(this).parent().find("td:eq(0)").text()
        $.ajax({
            url: "/kill/deleteTime",
            type: "POST",
            data: {id: id},
            success: function (result) {
                alert(result.info)
                closeshowKillTimeWindow()
                return false
            }
        })
        return false
    })

    /**
     * 关闭秒杀时间弹出框
     */
    function closeshowKillTimeWindow() {
        $("#showKillTime").modal('hide');
    }

    $(function () {
        selectAllGoodsByPage(pageNum, PageSize, goodsType)
    })

    /**
     * 定义商品的页数
     * @type {number}
     */
    var pageNum = 1
    /**
     * 定义商品的条数
     * @type {number}
     */
    var PageSize = 5
    /**
     * 获取需要的产品的类型
     */
    var goodsType = 0

    /**
     * 根据页码与条数，获取对应的商品信息
     * @param pageNum ： 商品页数，默认为1
     * @param pageSize ： 每页显示商品的条数
     */
    function selectAllGoodsByPage(pageNum, pageSize, goodsType) {
        $.ajax({
            url: '/goods/selectGoodsByPage',
            type: "POST",
            data: {
                pageNum: pageNum,
                pageSize: pageSize,
                goodsType: goodsType
            },
            success: function (result) {
                console.log(result)
                eachGoods(result.list)
                build_page_info(result, "#page_nav_area_goods", "#page_info_area_goods")
                build_page_nav(result, "#page_nav_area_goods", "#page_info_area_goods")
                //跳转到页面顶部
                $(window).scrollTop(0);
                $("#page_info_area_goods").show()
                $("#page_nav_area_goods").show()
            }
        })
    }

    /**
     * 遍历商品
     */
    function eachGoods(goods) {
        $("#goods_list").empty();
        $.each(goods, function (index, value) {
            var id = $("<td hidden='hidden'></td>").append(value.id);
            var goodsName = $("<td></td>").append(value.goodsName);
            var goodsDefaultAmount = $("<td></td>").append(value.goodsDefaultAmount);
            var goodsNowAmount = $("<td></td>").append(value.goodsNowAmount);
            var goodsInventory = $("<td></td>").append(value.goodsInventory);
            var goodsState = $("<td></td>").append(value.goodsState);
            var goodsId = $("<td hidden='hidden'></td>").append(value.goodsId);
            var goodsMerchantsId = $("<td hidden='hidden'></td>").append(value.goodsMerchantsId);
            var goodsMerchantsName = $("<td></td>").append(value.goodsMerchantsName);
            var goodsSellTime = $("<td></td>").append(value.goodsSellTime);
            var goodsDiscontinuedTime = $("<td></td>").append(value.goodsDiscontinuedTime);
            var update1 = $("<td class='goods-update1 btn btn-warning'>修改</td>");
            var delete1 = $("<td class='goods-delete1 btn btn-danger'>删除</td>");
            $("<tr></tr>").append(id)
                .append(goodsName)
                .append(goodsDefaultAmount)
                .append(goodsNowAmount)
                .append(goodsInventory)
                .append(goodsState)
                .append(goodsId)
                .append(goodsMerchantsId)
                .append(goodsMerchantsName)
                .append(goodsSellTime)
                .append(goodsDiscontinuedTime)
                .append(update1)
                .append(delete1)
                .appendTo("#goods_list")
        })
    }

    /**
     * 分页条的编写
     */
    var totalRecord, currentPage;

    function build_page_info(result, page_nav_area, page_info_area) {
        $(page_info_area).empty();
        $(page_info_area).append("当前" + result.pageNum + "页,总" +
            result.pages + "页,总" +
            result.total + "条记录");
        totalRecord = result.total;
        currentPage = result.pageNum;
    }

    function build_page_nav(result, page_nav_area, page_info_area) {
        $(page_nav_area).empty();
        var ul = $("<ul></ul>").addClass("pagination");
        var firstPageLi = $("<li></li>").append($("<a></a>").append("首页").attr("href", "#"));
        var prePageLi = $("<li></li>").append($("<a></a>").append("&laquo;"));
        if (result.hasPreviousPage == false) {
            firstPageLi.addClass("disabled");
            prePageLi.addClass("disabled");
        } else {
            firstPageLi.click(function () {
                selectAllGoodsByPage(1, 5, goodsType);
            });
            prePageLi.click(function () {
                selectAllGoodsByPage(result.pageNum - 1, 5, goodsType);
            });
        }
        var nextPageLi = $("<li></li>").append($("<a></a>").append("&raquo;"));
        var lastPageLi = $("<li></li>").append($("<a></a>").append("末页").attr("href", "#"));
        if (result.hasNextPage == false) {
            nextPageLi.addClass("disabled");
            lastPageLi.addClass("disabled");
        } else {
            nextPageLi.click(function () {
                selectAllGoodsByPage(result.pageNum + 1, 5, goodsType)
            });
            lastPageLi.click(function () {
                selectAllGoodsByPage(result.pages, 5, goodsType);
            });
        }
        //添加首页和前一页 的提示
        ul.append(firstPageLi).append(prePageLi);
        //1,2，3遍历给ul中添加页码提示
        $.each(result.navigatepageNums, function (index, item) {

            var numLi = $("<li></li>").append($("<a></a>").append(item));
            if (result.pageNum == item) {
                numLi.addClass("active");
            }
            numLi.click(function () {
                selectAllGoodsByPage(item, 5, goodsType)
            });
            ul.append(numLi);
        });
        //添加下一页和末页 的提示
        ul.append(nextPageLi).append(lastPageLi);

        //把ul加入到nav
        var navEle = $("<nav></nav>").append(ul);
        navEle.appendTo(page_nav_area);
    }

    $(document).on("click", ".goods-delete1", function () {
        var id = $(this).parent().find("td:eq(6)").text()
        alert(id)
        $.ajax({
            url: "/admin/deleteGoods",
            type: "POST",
            data: {
                goodsId: id
            },
            success: function (result) {
                alert(result.info)
            }
        })
    })

    /**
     * 定义一个查询用户的分页的num
     * @type {number}
     */
    var userPage = 1

    /**
     * 查询对应的用户数据
     * @param userPage
     */
    function selectUserByPage(userPage) {
        $("#user_management_tbody").empty();
        $.ajax({
            url: "/admin/selectUserByPage.html",
            type: "POST",
            data: {
                page: userPage
            },
            success: function (result) {
                console.log(result)
                eachUser(result.extend.pageInfo.list)
                build_page_info_user(result.extend.pageInfo, "#page_nav_area_user", "#page_info_area_user")
                build_page_nav_user(result.extend.pageInfo, "#page_nav_area_user", "#page_info_area_user")
                //跳转到页面顶部
                $(window).scrollTop(0);
                $("#page_info_area_user").show()
                $("#page_nav_area_user").show()
            }
        })
    }

    $(function () {
        selectUserByPage(userPage)
    })

    /**
     * 分页条的编写
     */
    var totalRecord1, currentPage1;

    function build_page_info_user(result, page_nav_area, page_info_area) {
        $(page_info_area).empty();
        $(page_info_area).append("当前" + result.pageNum + "页,总" +
            result.pages + "页,总" +
            result.total + "条记录");
        totalRecord1 = result.total;
        currentPage1 = result.pageNum;
    }

    function build_page_nav_user(result, page_nav_area, page_info_area) {
        $(page_nav_area).empty();
        var ul = $("<ul id='user-page-info'></ul>").addClass("pagination");
        var firstPageLi = $("<li></li>").append($("<a></a>").append("首页").attr("href", "#"));
        var prePageLi = $("<li></li>").append($("<a></a>").append("&laquo;"));
        if (result.hasPreviousPage == false) {
            firstPageLi.addClass("disabled");
            prePageLi.addClass("disabled");
        } else {
            firstPageLi.click(function () {
                selectUserByPage(1);
            });
            prePageLi.click(function () {
                selectUserByPage(result.pageNum - 1);
            });
        }
        var nextPageLi = $("<li></li>").append($("<a></a>").append("&raquo;"));
        var lastPageLi = $("<li></li>").append($("<a></a>").append("末页").attr("href", "#"));
        if (result.hasNextPage == false) {
            nextPageLi.addClass("disabled");
            lastPageLi.addClass("disabled");
        } else {
            nextPageLi.click(function () {
                selectUserByPage(result.pageNum + 1)
            });
            lastPageLi.click(function () {
                selectUserByPage(result.pages);
            });
        }
        //添加首页和前一页 的提示
        ul.append(firstPageLi).append(prePageLi);
        //1,2，3遍历给ul中添加页码提示
        $.each(result.navigatepageNums, function (index, item) {

            var numLi = $("<li></li>").append($("<a></a>").append(item));
            if (result.pageNum == item) {
                numLi.addClass("active");
            }
            numLi.click(function () {
                selectUserByPage(item)
            });
            ul.append(numLi);
        });
        //添加下一页和末页 的提示
        ul.append(nextPageLi).append(lastPageLi);

        //把ul加入到nav
        var navEle = $("<nav></nav>").append(ul);
        navEle.appendTo(page_nav_area);
    }

    function eachUser(list) {
        $.each(list, function (index, item) {
            var id = $("<td hidden='hidden'></td>").append(item.id);
            var userId = $("<td></td>").append(item.userId);
            var userName = $("<td></td>").append(item.userName);
            var userAliasName = $("<td></td>").append(item.userAliasName);
            var userSex = $("<td></td>").append(item.userSex);
            var userCardNo = $("<td></td>").append(item.userCardNo);
            var userEmail = $("<td></td>").append(item.userEmail);
            var userMobileNo = $("<td></td>").append(item.userMobileNo);
            var userIntegral = $("<td></td>").append(item.userIntegral);
            var userAmount = $("<td></td>").append(item.userAmount);
            var userBirth = $("<td></td>").append(item.userBirth);
            var userState = $("<td></td>").append(item.userState);
            var userAddress = $("<td></td>").append(item.userAddress);
            var userLevel = $("<td></td>").append(item.userLevel);
            var email1 = $("<td class='user-email1'><button class='btn btn-success'>发送邮件</button></td>");
            var update1 = $("<td class='user-update1'><button class='btn btn-warning'>修改</button></td>");
            var delete1 = $("<td class='user-delete1'><button class=' btn btn-danger'>删除</button></td>");
            $("<tr></tr>").append(id)
                .append(userId)
                .append(userName)
                .append(userSex)
                .append(userCardNo)
                .append(userEmail)
                .append(userMobileNo)
                .append(userIntegral)
                .append(userAmount)
                .append(userBirth)
                .append(userState)
                .append(userAddress)
                .append(userLevel)
                .append(email1)
                .append(update1)
                .append(delete1)
                .appendTo("#user_management_tbody")
        })
    }

    /**
     * 点击更新，跳转到更新个人信息页面
     */
    $(document).on("click", ".user-update1", function () {
        var id = $(this).parent().find("td:eq(1)").text()
        window.location.href = "/user/toUpdateUser/" + id
    })

    /**
     * 点击删除，删除对应的用户
     */
    $(document).on("click", ".user-delete1", function () {
        var array = new Array()
        array[0] = $(this).parent().find("td:eq(1)").text()
        deleteUser(array)
    })

    /**
     * 删除用户
     * @param arr
     */
    function deleteUser(arr) {
        $.ajax({
            url: "/user/deleteUser",
            type: "POST",
            async: false,
            cache: false,
            traditional: true,
            data: {
                userIds: arr
            },
            success: function (result) {
                alert(result.info)
            }
        });
        selectUserByPage(currentPage1)
    }

    /**
     * 开启秒杀模块
     */
    $(document).on("click","#restart_kill_model",function () {
        $.ajax({
            url: "/admin/restartKillModel",
            type: "GET",
            success: function (result) {
                alert(result.info)
            }
        })
    })

</script>

</body>
</html>
